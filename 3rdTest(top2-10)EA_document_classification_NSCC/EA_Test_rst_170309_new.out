
======================================================
Classification of text documents using sparse features
======================================================

This is an example showing how scikit-learn can be used to classify documents
by topics using a bag-of-words approach. This example uses a scipy.sparse
matrix to store the features and demonstrates various classifiers that can
efficiently handle sparse matrices.


Usage: document_classification_NSCC.py [options]

Options:
  -h, --help            show this help message and exit
  --report              Print a detailed classification report.
  --chi2_select=SELECT_CHI2
                        Select some number of features using a chi-squared
                        test
  --confusion_matrix    Print the confusion matrix.
  --top10               Print ten most discriminative terms per class for
                        every classifier.
  --all_categories      Whether to use all categories or not.
  --use_hashing         Use a hashing vectorizer.
  --n_features=N_FEATURES
                        n_features when using the hashing vectorizer.
  --filtered            Remove newsgroup information that is easily overfit:
                        headers, signatures, and quoting.

Loading NSCC  dataset for categories:
['EA99', 'EI02', 'EI03', 'EI01', 'EI06', 'EI07', 'EI04', 'EI05', 'EG08', 'EI08', 'EI09', 'EG09', 'EA08', 'EA09', 'EA02', 'EA03', 'EA01', 'EA06', 'EA07', 'EA04', 'EA05', 'EC10', 'EE99', 'EB08', 'EF99', 'EI11', 'EI10', 'EI12', 'EA15', 'EA14', 'EA11', 'EA10', 'EA13', 'EB99', 'EA12', 'EE08', 'EE09', 'EE06', 'EE07', 'EE04', 'EE05', 'EE02', 'EE03', 'EE01', 'EB01', 'EB03', 'EB02', 'EB05', 'EB04', 'EB07', 'EB06', 'EE11', 'EE10', 'EE13', 'EE12', 'EI99', 'EE14', 'EC08', 'EC09', 'EC01', 'EC02', 'EC03', 'EC04', 'EC05', 'EC06', 'EC07', 'EF05', 'EF04', 'EF06', 'EF01', 'EF03', 'EF02', 'ED10', 'ED11', 'EG04', 'EG05', 'EG06', 'EG07', 'EG01', 'EG02', 'EG03', 'ED07', 'ED06', 'ED05', 'ED04', 'ED03', 'ED02', 'ED01', 'ED09', 'ED08', 'EH10', 'EH11', 'EH12', 'EH13', 'EH14', 'EH15', 'EG99', 'EC99', 'ED99', 'EC11', 'EH09', 'EH08', 'EH03', 'EH02', 'EH01', 'EH07', 'EH06', 'EH05', 'EH04', 'EH99', 'EG10']
34787 23458
data loaded
Extracting features from the training data using a sparse vectorizer
n_samples: 34787, n_features: 53450

Extracting features from the test data using the same vectorizer
n_samples: 23458, n_features: 53450

================================================================================
Ridge Classifier
________________________________________________________________________________
Training: 
RidgeClassifier(alpha=1.0, class_weight=None, copy_X=True, fit_intercept=True,
        max_iter=None, normalize=False, random_state=None, solver='auto',
        tol=0.01)
train time: 14.127s
['EA99' 'EF02' 'ED99' ..., 'ED99' 'EE02' 'EE04']
test time:  0.116s
Precision:   0.480
Macro F1:   0.445
Micro F1:   0.480
             precision    recall  f1-score   support

       EA99       0.31      0.17      0.22       146
       EI02       0.59      0.35      0.44       109
       EI03       0.55      0.54      0.55       382
       EI01       0.56      0.41      0.48        94
       EI06       0.48      0.44      0.46       118
       EI07       0.83      0.22      0.34        23
       EI04       0.48      0.65      0.55       397
       EI05       0.49      0.47      0.48       131
       EG08       0.64      0.18      0.28        51
       EI08       0.78      0.33      0.47        42
       EI09       0.69      0.62      0.65       139
       EG09       0.69      0.45      0.55        55
       EA08       0.33      0.27      0.30       348
       EA09       0.43      0.65      0.52       701
       EA02       0.54      0.37      0.44       380
       EA03       0.33      0.33      0.33       309
       EA01       0.52      0.40      0.45       231
       EA06       0.44      0.50      0.47       337
       EA07       0.41      0.37      0.39       459
       EA04       0.46      0.38      0.41       277
       EA05       0.53      0.56      0.55       562
       EC10       0.25      0.05      0.08        21
       EE99       0.44      0.32      0.37       310
       EB08       0.88      0.21      0.34        33
       EF99       0.45      0.29      0.35       271
       EI11       0.44      0.43      0.43       244
       EI10       0.40      0.39      0.39        54
       EI12       0.54      0.49      0.51       215
       EA15       0.60      0.14      0.22        22
       EA14       0.39      0.38      0.38       100
       EA11       0.45      0.52      0.49       140
       EA10       0.61      0.71      0.66       391
       EA13       0.72      0.51      0.60        84
       EB99       0.46      0.23      0.30       167
       EA12       0.63      0.64      0.63        58
       EE08       0.42      0.24      0.31       113
       EE09       0.44      0.39      0.42       249
       EE06       0.59      0.59      0.59       322
       EE07       0.53      0.54      0.53       112
       EE04       0.60      0.43      0.50       125
       EE05       0.53      0.41      0.46       109
       EE02       0.41      0.70      0.52      1217
       EE03       0.57      0.69      0.63       328
       EE01       0.55      0.56      0.55       670
       EB01       0.48      0.46      0.47       596
       EB03       0.43      0.50      0.46       703
       EB02       0.47      0.53      0.50       521
       EB05       0.32      0.19      0.24       117
       EB04       0.46      0.39      0.42       103
       EB07       0.51      0.21      0.30       140
       EB06       0.47      0.30      0.37       209
       EE11       0.47      0.36      0.41       281
       EE10       0.46      0.23      0.30       217
       EE13       0.31      0.23      0.27       107
       EE12       0.58      0.31      0.40        95
       EI99       0.73      0.30      0.42       111
       EE14       0.33      0.11      0.17        45
       EC08       0.41      0.28      0.33        39
       EC09       0.49      0.57      0.53       182
       EC01       0.46      0.42      0.44       285
       EC02       0.49      0.37      0.42       418
       EC03       0.52      0.30      0.38       207
       EC04       0.73      0.54      0.62       168
       EC05       0.45      0.39      0.42       181
       EC06       0.47      0.31      0.38        87
       EC07       0.51      0.42      0.46       112
       EF05       0.42      0.51      0.46       210
       EF04       0.67      0.32      0.43       140
       EF06       0.48      0.72      0.57       968
       EF01       0.54      0.52      0.53       111
       EF03       0.48      0.51      0.49        87
       EF02       0.60      0.58      0.59       126
       ED10       0.45      0.56      0.50       352
       ED11       0.75      0.21      0.33       113
       EG04       0.59      0.45      0.51       146
       EG05       0.62      0.48      0.54        58
       EG06       0.68      0.69      0.69        87
       EG07       0.56      0.68      0.61       241
       EG01       0.77      0.77      0.77        47
       EG02       0.50      0.44      0.47        70
       EG03       0.57      0.38      0.46        61
       ED07       0.44      0.35      0.39       251
       ED06       0.35      0.31      0.33       277
       ED05       0.29      0.21      0.24       385
       ED04       0.44      0.60      0.51       695
       ED03       0.52      0.42      0.46       342
       ED02       0.50      0.48      0.49       153
       ED01       0.48      0.51      0.49       396
       ED09       0.46      0.60      0.52       204
       ED08       0.43      0.31      0.36       222
       EH10       0.57      0.43      0.49        92
       EH11       0.28      0.16      0.20        94
       EH12       0.62      0.15      0.24        55
       EH13       0.48      0.22      0.30        60
       EH14       1.00      0.05      0.10        40
       EH15       0.57      0.29      0.38        14
       EG99       0.61      0.67      0.64       155
       EC99       0.81      0.33      0.46        40
       ED99       0.38      0.24      0.29       245
       EC11       1.00      0.29      0.44         7
       EH09       0.65      0.63      0.64       126
       EH08       0.43      0.35      0.39        65
       EH03       0.54      0.68      0.60       100
       EH02       0.50      0.68      0.58       320
       EH01       0.53      0.57      0.55       192
       EH07       0.51      0.50      0.51       205
       EH06       0.68      0.54      0.60       110
       EH05       0.41      0.25      0.31        28
       EH04       0.65      0.47      0.54        66
       EH99       0.50      0.33      0.40        63
       EG10       0.87      0.58      0.70        69

avg / total       0.49      0.48      0.47     23458

dimensionality: 53450
density: 1.000000


================================================================================
L2 penalty
________________________________________________________________________________
Training: 
LinearSVC(C=1.0, class_weight=None, dual=False, fit_intercept=True,
     intercept_scaling=1, loss='squared_hinge', max_iter=1000,
     multi_class='ovr', penalty='l2', random_state=None, tol=0.001,
     verbose=0)
train time: 14.006s
['EH05' 'EF02' 'ED99' ..., 'ED99' 'EE01' 'EE04']
test time:  0.073s
Precision:   0.486
Macro F1:   0.463
Micro F1:   0.486
             precision    recall  f1-score   support

       EA99       0.27      0.22      0.24       146
       EI02       0.57      0.35      0.43       109
       EI03       0.54      0.54      0.54       382
       EI01       0.51      0.46      0.48        94
       EI06       0.54      0.42      0.47       118
       EI07       0.86      0.26      0.40        23
       EI04       0.51      0.62      0.56       397
       EI05       0.44      0.40      0.42       131
       EG08       0.59      0.25      0.36        51
       EI08       0.71      0.36      0.48        42
       EI09       0.70      0.63      0.66       139
       EG09       0.69      0.53      0.60        55
       EA08       0.31      0.28      0.30       348
       EA09       0.45      0.62      0.53       701
       EA02       0.55      0.41      0.47       380
       EA03       0.35      0.33      0.34       309
       EA01       0.45      0.42      0.43       231
       EA06       0.44      0.52      0.47       337
       EA07       0.41      0.37      0.39       459
       EA04       0.42      0.38      0.40       277
       EA05       0.55      0.57      0.56       562
       EC10       0.33      0.14      0.20        21
       EE99       0.41      0.37      0.39       310
       EB08       1.00      0.21      0.35        33
       EF99       0.41      0.34      0.37       271
       EI11       0.40      0.43      0.42       244
       EI10       0.50      0.39      0.44        54
       EI12       0.54      0.52      0.53       215
       EA15       0.57      0.18      0.28        22
       EA14       0.42      0.39      0.41       100
       EA11       0.49      0.54      0.51       140
       EA10       0.61      0.68      0.64       391
       EA13       0.71      0.54      0.61        84
       EB99       0.37      0.23      0.28       167
       EA12       0.71      0.62      0.66        58
       EE08       0.50      0.25      0.33       113
       EE09       0.41      0.41      0.41       249
       EE06       0.61      0.57      0.59       322
       EE07       0.55      0.56      0.56       112
       EE04       0.59      0.53      0.56       125
       EE05       0.56      0.45      0.50       109
       EE02       0.46      0.66      0.54      1217
       EE03       0.60      0.69      0.64       328
       EE01       0.49      0.59      0.54       670
       EB01       0.46      0.48      0.47       596
       EB03       0.46      0.51      0.48       703
       EB02       0.49      0.52      0.50       521
       EB05       0.37      0.24      0.29       117
       EB04       0.47      0.36      0.41       103
       EB07       0.52      0.25      0.34       140
       EB06       0.41      0.28      0.34       209
       EE11       0.46      0.36      0.40       281
       EE10       0.41      0.24      0.30       217
       EE13       0.40      0.30      0.34       107
       EE12       0.58      0.40      0.47        95
       EI99       0.60      0.38      0.46       111
       EE14       0.45      0.20      0.28        45
       EC08       0.41      0.28      0.33        39
       EC09       0.48      0.56      0.52       182
       EC01       0.44      0.44      0.44       285
       EC02       0.46      0.39      0.42       418
       EC03       0.49      0.33      0.39       207
       EC04       0.70      0.57      0.63       168
       EC05       0.43      0.40      0.42       181
       EC06       0.45      0.38      0.41        87
       EC07       0.48      0.41      0.44       112
       EF05       0.45      0.53      0.49       210
       EF04       0.60      0.40      0.48       140
       EF06       0.50      0.67      0.57       968
       EF01       0.61      0.58      0.59       111
       EF03       0.56      0.55      0.56        87
       EF02       0.60      0.58      0.59       126
       ED10       0.49      0.54      0.51       352
       ED11       0.70      0.23      0.35       113
       EG04       0.57      0.47      0.51       146
       EG05       0.61      0.47      0.53        58
       EG06       0.69      0.66      0.67        87
       EG07       0.60      0.68      0.64       241
       EG01       0.77      0.77      0.77        47
       EG02       0.56      0.54      0.55        70
       EG03       0.53      0.39      0.45        61
       ED07       0.39      0.36      0.38       251
       ED06       0.32      0.34      0.33       277
       ED05       0.28      0.23      0.25       385
       ED04       0.46      0.60      0.52       695
       ED03       0.53      0.42      0.47       342
       ED02       0.54      0.54      0.54       153
       ED01       0.50      0.49      0.49       396
       ED09       0.46      0.59      0.52       204
       ED08       0.46      0.34      0.39       222
       EH10       0.59      0.51      0.55        92
       EH11       0.24      0.16      0.19        94
       EH12       0.41      0.13      0.19        55
       EH13       0.40      0.27      0.32        60
       EH14       0.44      0.10      0.16        40
       EH15       0.62      0.36      0.45        14
       EG99       0.63      0.64      0.64       155
       EC99       0.71      0.42      0.53        40
       ED99       0.30      0.25      0.27       245
       EC11       1.00      0.29      0.44         7
       EH09       0.62      0.64      0.63       126
       EH08       0.41      0.37      0.39        65
       EH03       0.61      0.69      0.64       100
       EH02       0.53      0.67      0.59       320
       EH01       0.51      0.56      0.54       192
       EH07       0.58      0.52      0.55       205
       EH06       0.71      0.60      0.65       110
       EH05       0.42      0.29      0.34        28
       EH04       0.67      0.47      0.55        66
       EH99       0.53      0.46      0.49        63
       EG10       0.84      0.62      0.72        69

avg / total       0.49      0.49      0.48     23458

dimensionality: 53450
density: 1.000000


________________________________________________________________________________
Training: 
SGDClassifier(alpha=0.0001, average=False, class_weight=None, epsilon=0.1,
       eta0=0.0, fit_intercept=True, l1_ratio=0.15,
       learning_rate='optimal', loss='modified_huber', n_iter=50, n_jobs=1,
       penalty='elasticnet', power_t=0.5, random_state=None, shuffle=True,
       verbose=0, warm_start=False)
train time: 25.274s
['EE02' 'EF02' 'ED99' ..., 'EC01' 'EE01' 'EE04']
test time:  0.114s
Precision:   0.457
Macro F1:   0.406
Micro F1:   0.457
             precision    recall  f1-score   support

       EA99       0.29      0.13      0.18       146
       EI02       0.58      0.26      0.36       109
       EI03       0.52      0.53      0.53       382
       EI01       0.52      0.38      0.44        94
       EI06       0.49      0.42      0.45       118
       EI07       1.00      0.04      0.08        23
       EI04       0.44      0.67      0.53       397
       EI05       0.45      0.37      0.41       131
       EG08       0.62      0.16      0.25        51
       EI08       0.76      0.31      0.44        42
       EI09       0.63      0.62      0.62       139
       EG09       0.58      0.40      0.47        55
       EA08       0.33      0.26      0.29       348
       EA09       0.41      0.64      0.50       701
       EA02       0.53      0.34      0.42       380
       EA03       0.33      0.31      0.32       309
       EA01       0.47      0.35      0.40       231
       EA06       0.41      0.46      0.43       337
       EA07       0.39      0.35      0.37       459
       EA04       0.45      0.36      0.40       277
       EA05       0.52      0.55      0.54       562
       EC10       0.33      0.10      0.15        21
       EE99       0.40      0.25      0.31       310
       EB08       1.00      0.12      0.22        33
       EF99       0.46      0.23      0.30       271
       EI11       0.45      0.42      0.43       244
       EI10       0.42      0.41      0.41        54
       EI12       0.49      0.46      0.47       215
       EA15       0.50      0.09      0.15        22
       EA14       0.40      0.39      0.39       100
       EA11       0.43      0.49      0.46       140
       EA10       0.59      0.71      0.65       391
       EA13       0.58      0.46      0.52        84
       EB99       0.52      0.16      0.25       167
       EA12       0.59      0.55      0.57        58
       EE08       0.41      0.23      0.29       113
       EE09       0.38      0.39      0.38       249
       EE06       0.53      0.59      0.56       322
       EE07       0.50      0.53      0.52       112
       EE04       0.60      0.40      0.48       125
       EE05       0.48      0.38      0.42       109
       EE02       0.40      0.69      0.51      1217
       EE03       0.55      0.67      0.61       328
       EE01       0.44      0.56      0.49       670
       EB01       0.46      0.47      0.46       596
       EB03       0.39      0.49      0.44       703
       EB02       0.47      0.51      0.49       521
       EB05       0.36      0.18      0.24       117
       EB04       0.44      0.40      0.42       103
       EB07       0.59      0.19      0.28       140
       EB06       0.40      0.29      0.33       209
       EE11       0.47      0.29      0.36       281
       EE10       0.43      0.12      0.19       217
       EE13       0.33      0.21      0.26       107
       EE12       0.52      0.28      0.37        95
       EI99       0.80      0.18      0.29       111
       EE14       0.40      0.09      0.15        45
       EC08       0.32      0.21      0.25        39
       EC09       0.43      0.55      0.49       182
       EC01       0.45      0.40      0.43       285
       EC02       0.44      0.31      0.37       418
       EC03       0.58      0.24      0.34       207
       EC04       0.68      0.45      0.54       168
       EC05       0.41      0.38      0.39       181
       EC06       0.50      0.25      0.34        87
       EC07       0.52      0.35      0.42       112
       EF05       0.39      0.49      0.43       210
       EF04       0.60      0.32      0.42       140
       EF06       0.48      0.71      0.57       968
       EF01       0.51      0.50      0.50       111
       EF03       0.52      0.46      0.49        87
       EF02       0.59      0.55      0.57       126
       ED10       0.45      0.56      0.50       352
       ED11       0.63      0.15      0.24       113
       EG04       0.55      0.40      0.46       146
       EG05       0.67      0.38      0.48        58
       EG06       0.64      0.67      0.66        87
       EG07       0.50      0.66      0.57       241
       EG01       0.74      0.74      0.74        47
       EG02       0.50      0.46      0.48        70
       EG03       0.62      0.30      0.40        61
       ED07       0.39      0.31      0.35       251
       ED06       0.37      0.29      0.33       277
       ED05       0.34      0.18      0.23       385
       ED04       0.38      0.62      0.47       695
       ED03       0.52      0.44      0.47       342
       ED02       0.53      0.46      0.49       153
       ED01       0.43      0.50      0.46       396
       ED09       0.41      0.62      0.49       204
       ED08       0.41      0.30      0.34       222
       EH10       0.56      0.35      0.43        92
       EH11       0.20      0.09      0.12        94
       EH12       0.55      0.11      0.18        55
       EH13       0.40      0.17      0.24        60
       EH14       1.00      0.05      0.10        40
       EH15       0.00      0.00      0.00        14
       EG99       0.56      0.55      0.56       155
       EC99       0.75      0.23      0.35        40
       ED99       0.45      0.19      0.27       245
       EC11       1.00      0.14      0.25         7
       EH09       0.63      0.59      0.61       126
       EH08       0.41      0.29      0.34        65
       EH03       0.59      0.68      0.63       100
       EH02       0.49      0.66      0.56       320
       EH01       0.50      0.54      0.52       192
       EH07       0.52      0.45      0.48       205
       EH06       0.66      0.54      0.59       110
       EH05       0.37      0.25      0.30        28
       EH04       0.64      0.45      0.53        66
       EH99       0.51      0.35      0.42        63
       EG10       0.87      0.58      0.70        69

avg / total       0.47      0.46      0.44     23458

dimensionality: 53450
density: 0.022686


